if(typeof(usig)=="undefined"){usig={}}usig.AutoCompleterDialog=(function(a){return function(h,d){var b=document.getElementById(h),i=b.value,o=a.extend({},usig.AutoCompleterDialog.defaults,d),r=o.idDiv||"usig_acv_"+h,n=null,g=-1,q=false,c=false,l=0,w=null,f={},x={arrUp:38,arrDn:40,enter:13,esc:27};function k(){clearTimeout(n)}function p(){if(o.debug){usig.debug("AutoCompleterDialog: resetting hideTimeout")}k();if(o.autoHideTimeout>0){n=s.defer(o.autoHideTimeout,this)}}function s(){if(w){w.fadeOut("slow")}}function t(y){k();if(w){if(o.debug){usig.debug("AutoCompleterDialog: updating current div...")}a("#"+r+" div.content").html(y);w.show();g=-1}else{if(o.debug){usig.debug("AutoCompleterDialog: creating new div...")}w=a('<div id="'+r+'" class="usig_acv">						<div class="header">							<div class="corner"/>							<div class="bar"/>						</div>						<div class="content">'+y+'</div>						<div class="footer">							<div class="corner"/>							<div class="bar"/>						</div>					</div>');var z=a(b).offset();w.css({position:"absolute",left:z.left+"px",top:(z.top+b.offsetHeight+parseInt(o.offsetY))+"px",width:b.offsetWidth,zIndex:o.zIndex});a("body").append(w);w.mouseover(k.createDelegate(this));w.mouseout(p.createDelegate(this));g=-1;w.show()}n=s.defer(o.autoHideTimeout,this)}function j(){if(w){g=-1;a("ul.options li.highlight",w).removeClass("highlight")}}function e(y){if(w){g=y;a("ul.options li.highlight",w).removeClass("highlight");if(typeof(y)=="string"){a('ul.options li:has(a[name="'+y+'"])',w).addClass("highlight");g=parseInt(y.replace(r,""))}else{a("ul.options li:has(a)",w).slice(y,y+1).addClass("highlight")}if(o.debug){usig.debug("AutoCompleterDialog. highlighted: "+g)}}}function m(y){var F=new y.constructor(y);F.marked=Array();var E=i.split(" ");for(var B=0;B<E.length;B++){var D=F.toLowerCase().indexOf(E[B].toLowerCase());if(D<0){var D=F.toLowerCase().indexOf(E[B].translate("áéíóúüÁÉÍÓÚÜàèìòùÀÈÌÒÙ","aeiouuAEIOUUaeiouAEIOU").toLowerCase())}if(D>=0){for(var C=0;C<E[B].length;C++){F.marked[D+C]=true}}}var A="";var z=false;for(var B=0;B<F.length;B++){if(F.marked[B]&&!z){A=A+"<em>"+F.substring(B,B+1);z=true}else{if((F.marked[B]&&z)||(!F.marked[B]&&!z)){A=A+F.substring(B,B+1)}else{A=A+"</em>"+F.substring(B,B+1);z=false}}}if(z){A=A+"</em>"}return A}function v(y){if(typeof(o.onSelection)=="function"){k();s();o.onSelection(y)}}function u(){if(o.debug){usig.debug("usig.AutoCompleterDialog: reset")}k();g=-1;l=0;f={}}this.setOptions=function(y){o=a.extend({},o,y)};this.update=function(y){if(y==""&&w){w.hide()}i=y;u()};this.getOptions=function(){return o};this.show=function(z,y){var B="";var C=isNaN(parseInt(y))?0:parseInt(y);if(y!=undefined){if(C>0){a("ul.options li",w).slice(C).remove();l=a("ul.options li a",w).length}}else{l=0;f={}}var A=m;a.each(z,function(D,E){if(l>=o.maxOptions){return false}if(typeof(E)=="string"){B+='<li class="acv_op message">'+E+"</li>"}else{if(typeof(o.optionsFormatter)=="function"){B+=o.optionsFormatter(E,r+l,A);f[r+l]=E;l++}else{if(typeof(E.toString)=="function"){B+='<li class="acv_op"><a href="#" class="acv_op" name="'+r+l+'"><span class="tl"/><span class="tr"/><span>'+A(E.toString())+"</span></a></li>";f[r+l]=E;l++}}}});if(o.debug){usig.debug("AutoCompleterDialog: showing "+l+" options: ["+z+"]")}if((y===true||!isNaN(parseInt(y)))&&w&&a("ul.options li a",w).length>0){if(o.debug){usig.debug("AutoCompleterDialog: appending to the end of existing list...")}if(l>1&&c){c=false;j()}a("ul.options",w).append(B)}else{if(o.idDiv){if(o.debug){usig.debug("AutoCompleterDialog: recreating suggestions list...")}w.html('<div class="content"><ul class="options">'+B+"</ul></div>");w.show()}else{if(o.debug){usig.debug("AutoCompleterDialog: creating suggestions list...")}t('<ul class="options">'+B+"</ul>")}}a("ul.options li.acv_op",w).mouseover((function(E,D){if(E.target.name){D(E.target.name)}else{D(a(E.target).parents("a").attr("name"))}q=true}).createDelegate(this,[e],1));a("ul.options li.acv_op",w).mouseout((function(D){if(q){q=false;j()}}).createDelegate(this));a("ul.options li.acv_op",w).click((function(E){if(o.debug){usig.debug("AutoCompleterDialog: click")}E.preventDefault();var F=E.target?E.target:E.srcElement;var D=a(F).parents("a.acv_op").attr("name")||a("a.acv_op",a(F)).attr("name")||a(F).attr("name");v(f[D])}).createDelegate(this));if(o.autoSelect&&l==1){g=0;c=true;e(g)}};this.showMessage=function(y){if(o.idDiv){w.html('<div class="content"><div class="message">'+y+"</div></div>");w.show()}else{t('<div class="message">'+y+"</div>")}};this.keyUp=function(y){if(g==undefined){g=-1}if((y==x.arrDn||y==x.arrUp)&&l>0){if(w.css("display")!="block"){w.show()}else{p();g=y==x.arrDn?(g+1).constrain(0,l-1):(g-1).constrain(0,l-1);if(o.debug){usig.debug("AutoCompleterDialog: highlighting "+g+"...")}e(g)}}if(x.enter==y){if(w&&w.css("display")!="block"){if(typeof(o.onEnterWithoutSelection)=="function"){o.onEnterWithoutSelection(i)}w.show()}else{if(g>=0||l==1){if(g>=0){v(f[r+g])}else{v(f[r+"0"])}}else{if(l>0&&typeof(o.onEnterWithoutSelection)=="function"){if(o.debug){usig.debug("AutoCompleterDialog: ENTER without selection...")}o.onEnterWithoutSelection(i)}}}}if(x.esc==y){k();s()}};this.remove=function(){k();if(w){w.remove()}};this.onSelection=function(y){if(typeof(y)=="function"){o.onSelection=y}};this.selectOption=function(y){if(l>y){if(w.css("display")!="block"){w.show()}e(y);v(f[r+g]);return true}return false};this.getNumSuggestions=function(){return l};this.getSuggestion=function(y){var z=y||0;if(l>z){return f[r+z]}return false};this.changeSkin=function(y){usig.removeCss(o.rootUrl+"css/usig.AutoCompleterDialog."+o.skin+".css");o.skin=y;usig.loadCss(o.rootUrl+"css/usig.AutoCompleterDialog."+o.skin+".css")};this.hide=function(){if(o.debug){usig.debug("AutoCompleterDialog: hide")}k();if(w){w.hide()}};if(o.skin!="custom"){usig.loadCss(o.rootUrl+"css/usig.AutoCompleterDialog."+o.skin+".css")}if(o.idDiv){w=a("#"+o.idDiv);w.addClass("usig_acv")}}})(jQuery);usig.AutoCompleterDialog.defaults={maxOptions:10,debug:false,offsetY:-5,zIndex:10000,autoHideTimeout:5000,autoSelect:true,rootUrl:"//servicios.usig.buenosaires.gob.ar/usig-js/3.1/",skin:"usig4"};