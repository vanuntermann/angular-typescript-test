if(typeof(usig)=="undefined"){usig={}}if(typeof(usig.inventario)=="undefined"){usig.inventario={}}usig.inventario.Objeto=(function(a){return function(b,c){this.id=0;this.nombre=usig.inventario.Objeto.defaults.texts.noName;this.ubicacion=null;this.clase=c;this.direccionAsociada=null;this.fechaAlta=null;this.fechaUltimaModificacion=null;this.datos={};this.rawData={};this.descripcion=null;if(c!=undefined){this.descripcion=c.getNombre()}this.fill=function(d){if(d.id){this.id=d.id}if(d.nombre){this.nombre=d.nombre}if(d.ubicacion){this.ubicacion=new usig.inventario.Ubicacion(d.ubicacion);this.rawData.ubicacion=d.ubicacion}if(d.fechaAlta){this.fechaAlta=new Date(d.fechaAlta);this.rawData.fechaAlta=d.fechaAlta}if(d.fechaUltimaModificacion){this.fechaUltimaModificacion=new Date(d.fechaUltimaModificacion);this.rawData.fechaUltimaModificacion=d.fechaUltimaModificacion}if(d.direccionAsociada){try{this.direccionAsociada=usig.Direccion.fromObj(d.direccionAsociada);this.rawData.direccionAsociada=d.direccionAsociada}catch(f){}}else{if(d.direccionNormalizada&&usig.NormalizadorDirecciones){try{this.direccionAsociada=usig.NormalizadorDirecciones.normalizar(d.direccionNormalizada,10,true)[0];this.direccionAsociada.setCoordenadas(this.ubicacion.getCentroide());if(d.smp){this.direccionAsociada.setSmp(d.smp)}this.rawData.direccionAsociada=this.direccionAsociada.toJson()}catch(f){usig.debug(f)}}}if(d.contenido){var g=this.datos;a.each(d.contenido,function(h,e){g[e.nombreId]={alias:e.nombre,valor:e.valor,pos:e.posicion}});if(this.datos.nombre){this.nombre=this.datos.nombre.valor}}this.rawData=a.extend(this.rawData,d)};this.toString=function(){return this.nombre};this.getRawData=function(){return this.rawData};this.clone=function(){var d=new usig.inventario.Objeto(b,c);return a.extend(true,d,this)};this.toJson=function(){var d=this.getRawData();if(this.clase&&this.clase.toJson){d.clase=this.clase.toJson()}if(this.direccionAsociada&&this.direccionAsociada.toJson){d.direccionAsociada=this.direccionAsociada.toJson()}return d};this.isEqual=function(d){return d instanceof usig.inventario.Objeto&&d.id==this.id};this.getSmp=function(){return this.rawData.smp||(this.direccionAsociada?this.direccionAsociada.getSmp():"")};this.getCoordenadas=function(){if(this.ubicacion){return this.ubicacion.getCentroide()}else{if(this.direccionAsociada){return this.direccionAsociada.getCoordenadas()}}};this.fill(b);this.rawData=a.extend(this.rawData,b)}})(jQuery);usig.inventario.Objeto.fromObj=function(a){return new usig.inventario.Objeto(a,usig.inventario.Clase.fromObj(a.clase))};usig.inventario.Objeto.defaults={texts:{noName:"Sin Nombre"}};if(typeof(usig)=="undefined"){usig={}}usig.SuggesterDirecciones=(function(a){return usig.Suggester.extend({init:function(b){var c=a.extend({},usig.SuggesterDirecciones.defaults,b);this._super("Direcciones",c);if(!this.opts.normalizadorDirecciones){this.opts.normalizadorDirecciones=usig.NormalizadorDirecciones.init({aceptarCallesSinAlturas:this.opts.acceptSN,callesEnMinusculas:this.opts.callesEnMinusculas,onReady:this.opts.onReady});this.cleanList.push(this.opts.normalizadorDirecciones)}if(!this.opts.geoCoder){this.opts.geoCoder=new usig.GeoCoder(this.opts);this.cleanList.push(this.opts.geoCoder)}},getSuggestions:function(d,g,f){if(this.opts.debug){usig.debug("usig.SuggesterDirecciones.getSuggestions('"+d+"')")}var b=f!=undefined?f:this.opts.maxSuggestions;try{g(this.opts.normalizadorDirecciones.normalizar(d,b))}catch(c){if(this.opts.ignorarTextoSobrante){try{var e=this.opts.normalizadorDirecciones.buscarDireccion(d);if(e!==false){g([e.match])}else{g(c)}}catch(c){g(c)}}else{g(c)}}},getGeoCoding:function(b,c){if(this.opts.debug){usig.debug("usig.SuggesterDirecciones.getGeoCoding(obj, callback)")}if(!(b instanceof usig.Direccion)){c(new usig.Suggester.GeoCodingTypeError())}else{this.opts.geoCoder.geoCodificarDireccion(b,c)}},ready:function(){return this.opts.normalizadorDirecciones.listo()},setOptions:function(b){opts=a.extend({},this.opts,b);this._super(opts);this.opts.geoCoder.setOptions(opts)}})})(jQuery);usig.SuggesterDirecciones.defaults={debug:false,serverTimeout:5000,maxRetries:5,maxSuggestions:10,acceptSN:true,callesEnMinusculas:false,ignorarTextoSobrante:true};usig.registerSuggester("Direcciones",usig.SuggesterDirecciones);