if(typeof(usig)=="undefined"){usig={}}if(typeof(usig.debug)=="undefined"){usig.debug=function(a){if(window.console&&window.console.log){window.console.log(a)}}}usig.DataManagerDefaults={retry:true,retryTimeout:1000,expirationTime:600000,debug:false,ajaxParams:{type:"GET",dataType:"jsonp"}};usig.DataManager=(function(a){return new function(){var c={};var g={};var f=usig.DataManagerDefaults;this.setOpts=function(i){f=a.extend(true,{},usig.DataManagerDefaults,i)};this.registerClass=function(i,j){g[i]=a.extend(true,{},usig.DataManagerDefaults,j);c[i]={};if(f.debug){usig.debug(c);usig.debug(g)}};function d(i,k){var j=new Date();if(typeof(c[i][k])!="undefined"){return(j-c[i][k].storeTime)<g[i].expirationTime}else{return false}}this.getData=function(i,k,j){if(typeof(g[i])!="undefined"){if(this.isCached(i,k)){if(typeof(j.success)=="function"){j.success(c[i][k].data)}else{return c[i][k].data}}else{if(typeof(g[i].getter)=="function"){if(f.debug){usig.debug("Calling getter with params: "+i+"/"+k);usig.debug(j)}if(typeof(j.success)=="function"){j.success(g[i].getter(i,k,j))}else{return g[i].getter(i,k,j)}}else{if(f.debug){usig.debug("Trying to make Ajax request with params: "+i+"/"+k);usig.debug(j)}e.createDelegate(this,[i,k,j])()}}}else{if(f.debug){usig.debug("La clase "+i+" no est치 registrada.")}}};this.storeData=function(i,k,j){c[i][k]={data:j,storeTime:new Date()}};this.removeData=function(i,j){c[i][j]=undefined};this.isCached=function(i,j){return typeof(c[i])!="undefined"&&typeof(c[i][j])!="undefined"&&d(i,j)};this.isRegistered=function(i){return(typeof(g[i])!="undefined")};function b(k,i,l,j){clearTimeout(c[i][l]);if(f.debug){usig.debug("Received data for: "+i+"/"+l);usig.debug(k)}this.storeData(i,l,k);j(k)}function h(j,i,m,l){if(j!=null&&j.readyState!=0&&j.readyState!=4){if(f.debug){usig.debug("Aborting request...")}j.abort();var k=a.ajax(l);if(f.debug){usig.debug("Retrying request...")}c[i][m]=setTimeout(h.createDelegate(this,[k,i,m,l]),g[i].retryTimeout)}}function e(i,m,l){if(typeof(l.success)!="function"){if(f.debug){usig.debug("params.success tiene que ser una funci칩n que acepte como par치metro el dato solicitado porque puede no estar inmediatamente disponible.")}return}if(typeof(l.error)!="undefined"&&typeof(l.error)!="function"){if(f.debug){usig.debug("params.error tiene que ser una funci칩n.")}return}var k=a.extend(true,{},usig.DataManagerDefaults.ajaxParams,g[i].ajaxParams);if(typeof(k.url)=="undefined"){if(f.debug){usig.debug("Falta definir ajaxParams.url para la clase: "+i)}return}k.success=b.createDelegate(this,[i,m,l.success],1);k.error=l.error;k.data=l;var j=a.ajax(k);if(g[i].retry){c[i][m]=setTimeout(h.createDelegate(this,[j,i,m,k]),g[i].retryTimeout)}}}})(jQuery);