jQuery.extendIf=function(b,d){if(b&&d){for(var a in d){if(typeof b[a]=="undefined"){b[a]=d[a]}}}return b};if(typeof(Ext)=="undefined"){jQuery.extend(Function.prototype,{createCallback:function(){var a=arguments;var b=this;return function(){return b.apply(window,a)}},createDelegate:function(c,b,a){var d=this;return function(){var f=b||arguments;if(a===true){f=Array.prototype.slice.call(arguments,0);f=f.concat(b)}else{if(typeof a=="number"){f=Array.prototype.slice.call(arguments,0);var e=[a,0].concat(b);Array.prototype.splice.apply(f,e)}}return d.apply(c||window,f)}},defer:function(c,e,b,a){var d=this.createDelegate(e,b,a);if(c){return setTimeout(d,c)}d();return 0},createSequence:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){var d=c.apply(this||window,arguments);b.apply(a||this||window,arguments);return d}},createInterceptor:function(b,a){if(typeof b!="function"){return this}var c=this;return function(){b.target=this;b.method=c;if(b.apply(a||this||window,arguments)===false){return}return c.apply(this||window,arguments)}}});jQuery.extendIf(String,{escape:function(a){return a.replace(/('|\\)/g,"\\$1")},leftPad:function(d,b,c){var a=new String(d);if(!c){c=" "}while(a.length<b){a=c+a}return a.toString()},format:function(b){var a=Array.prototype.slice.call(arguments,1);return b.replace(/\{(\d+)\}/g,function(c,d){return a[d]})}})}String.prototype.isInteger=function(){return !isNaN(parseInt(this))};String.prototype.isFloat=function(){return !isNaN(parseFloat(this))};String.prototype.toggle=function(b,a){return this==b?a:b};String.prototype.trim=function(){var a=/^\s+|\s+$/g;return function(){return this.replace(a,"")}}();String.prototype.translate=function(d,c){if(!(d.length&&c.length)||d.length!=c.length){return this}var b=this;for(var a=0;a<d.length;a++){if(typeof(d)=="string"){b=b.replace(new RegExp(d.charAt(a),"g"),c.charAt(a))}else{b=b.replace(new RegExp(d[a],"g"),c[a])}}return b};String.prototype.isDigit=function(){return/^\d+$/.test(this)};String.prototype.removeWords=function(e){var d=this.split(" ");var c=new Array();for(var b=0;b<d.length;b++){c.push(d[b]);for(var a=0;a<e.length;a++){if(c[b]==e[a]){c.pop();break}}}return c.join(" ")};jQuery.extendIf(Number.prototype,{constrain:function(b,a){return Math.min(Math.max(this,b),a)},isInteger:function(){return !isNaN(parseInt(this))},isFloat:function(){return !isNaN(parseFloat(this))}});jQuery.extendIf(Array.prototype,{indexOf:function(c){for(var b=0,a=this.length;b<a;b++){if(this[b]==c){return b}}return -1},removeObject:function(b){var a=this.indexOf(b);if(a!=-1){this.splice(a,1)}return this},binarySearch:function binarySearch(f,b){var a=0,e=this.length-1,c,d;while(a<=e){c=parseInt((a+e)/2,10);d=b(this[c],f);if(d<0){a=c+1;continue}if(d>0){e=c-1;continue}return c}return -1},inject:function(c,b){for(var a=0;a<this.length;a++){c=b(c,this[a],a)}return c},map:function(d,c){var a=new Array(this.length);for(var b=0,e=this.length;b<e;b++){if(b in this){a[b]=d.call(c,this[b],b,this)}}return a},intersect:function(){if(!arguments.length){return[]}var e=this;var d=a2=null;var h=0;while(h<arguments.length){d=[];a2=arguments[h];var c=e.length;var b=a2.length;for(var g=0;g<c;g++){for(var f=0;f<b;f++){if(e[g]===a2[f]){d.push(e[g])}}}e=d;h++}return d.unique()},unique:function(){var c=[];var b=this.length;for(var e=0;e<b;e++){for(var d=e+1;d<b;d++){if(this[e]===this[d]){d=++e}}c.push(this[e])}return c}});Date.prototype.getElapsed=function(a){return Math.abs((a||new Date()).getTime()-this.getTime())};if(typeof(usig)=="undefined"){usig={}}usig.debug=function(a){if(window.console&&window.console.log){window.console.log(a)}};if(typeof(usig)=="undefined"){usig={}}jQuery.extendIf(usig,{loadingJs:[],loadingJsListeners:{},__callLoadJsListeners:function(b){for(var c=0,a=usig.loadingJsListeners[b].length;c<a;c++){usig.loadingJsListeners[b][c]()}},loadJs:function(b,e){if(usig.loadingJs.indexOf(b)<0){usig.loadingJs.push(b);usig.loadingJsListeners[b]=(typeof(e)=="function")?[e]:[];var a=document.createElement("script"),c=document.getElementsByTagName("head")[0],d=false;a.onload=a.onreadystatechange=function(){if((a.readyState&&a.readyState!=="complete"&&a.readyState!=="loaded")||d){return false}a.onload=a.onreadystatechange=null;d=true;usig.__callLoadJsListeners(b)};a.src=b;c.insertBefore(a,c.firstChild)}else{usig.loadingJsListeners[b].push(e)}},loadCss:function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);if(typeof b!="undefined"){document.getElementsByTagName("head")[0].appendChild(b)}},removeJs:function(a){var c=document.getElementsByTagName("script");for(var b=c.length;b>=0;b--){if(c[b]&&c[b].getAttribute("src")!=null&&c[b].getAttribute("src").indexOf(a)!=-1){c[b].parentNode.removeChild(c[b])}}},removeCss:function(a){var c=document.getElementsByTagName("link");for(var b=c.length;b>=0;b--){if(c[b]&&c[b].getAttribute("href")!=null&&c[b].getAttribute("href").indexOf(a)!=-1){c[b].parentNode.removeChild(c[b])}}},Animator:function(c,d,e,f){var b=0;function a(){if(c.length>b){d(c[b]);b++;setTimeout(a,e)}else{if(typeof(f)=="function"){f()}}}this.stop=function(){b=c.length+1};a()},parseUri:function(e){var a=["source","protocol","authority","domain","port","path","directoryPath","fileName","query","anchor"],b=new RegExp("^(?:([^:/?#.]+):)?(?://)?(([^:/?#]*)(?::(\\d*))?)((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?").exec(e),d={};for(var c=0;c<10;c++){d[a[c]]=(b[c]?b[c]:"")}if(d.directoryPath.length>0){d.directoryPath=d.directoryPath.replace(/\/?$/,"/")}return d},registeredSuggesters:{},registerSuggester:function(a,b){usig.registeredSuggesters[a]=b},createSuggester:function(b,a){if(typeof(usig.registeredSuggesters[b])!="function"){throw"Suggester "+b+" is not registered.";return null}return new usig.registeredSuggesters[b](a)}});jQuery.expr[":"].Contains=function(c,d,b){return jQuery(c).text().toUpperCase().indexOf(b[3].toUpperCase())>=0};jQuery.expr[":"].ContainsFilter=function(c,d,b){if(c.innerHTML.indexOf("data-filter")>=0){var e=c.innerHTML.match(/data-filter\=\"(.*?)\"/)[1].toUpperCase().indexOf(b[3].toUpperCase())>=0}return jQuery(c).text().toUpperCase().indexOf(b[3].toUpperCase())>=0||e};(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;jQuery.Class=function(){};jQuery.Class.create=function(g){var f=this.prototype;a=true;var e=new this();a=false;for(var d in g){e[d]=typeof g[d]=="function"&&typeof f[d]=="function"&&b.test(g[d])?(function(h,i){return function(){var k=this._super;this._super=f[h];var j=i.apply(this,arguments);this._super=k;return j}})(d,g[d]):g[d]}function c(){if(!a&&c.prototype.init){return c.prototype.init.apply(this,arguments)}}c.prototype=e;c.prototype.constructor=c;c.extend=arguments.callee;return c}})();if(typeof(usig)=="undefined"){usig={}}usig.AjaxComponent=(function(a){return jQuery.Class.create({init:function(e,b,d){this.name=e;var c=d.dataType||(window.location.host==usig.parseUri(b).authority?"json":"jsonp");this.defaultParams={type:"GET",url:b,dataType:c};this.opts=a.extend({},usig.AjaxComponent.defaults,d);if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") dataType: "+c)}},mkRequest:function(g,k,i,d){var c=null,h=0;function b(m,n){clearTimeout(c);if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Ajax Request Success")}if(typeof(this.opts.afterServerResponse)=="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") calling afterServerResponse")}this.opts.afterServerResponse()}n(m)}function f(m,n){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Ajax Request Error")}if(h>=this.opts.maxRetries){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Ajax Request Max Errors Reached")}clearTimeout(c);if(typeof(n)=="function"){n(m)}}else{if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Ajax Request Error. Retrying... ("+h+")")}}}function j(m,o){if(m!=null&&m.readyState!=0&&m.readyState!=4){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Aborting request...")}m.abort();if(typeof(this.opts.afterAbort)=="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") calling afterAbort")}this.opts.afterAbort()}if(this.opts.maxRetries>h){h++;var n=a.ajax(o);if(typeof(this.opts.afterRetry)=="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") calling afterRetry")}this.opts.afterRetry()}if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") Retrying request... ("+h+")")}c=setTimeout(j.createDelegate(this,[n,l]),this.opts.serverTimeout)}else{if(this.opts.debug){usig.debug("ERROR: Se alcanzo el maximo numero de reintentos al servidor sin exito.")}if(typeof(o.error)=="function"){o.error("Se produjo un error al intentar acceder al servidor: "+o.url)}}}}if(typeof(k)!="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") success tiene que ser una función que acepte como parámetro el dato solicitado porque puede no estar inmediatamente disponible.")}return}if(typeof(i)!="undefined"&&typeof(i)!="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") error tiene que ser una función.")}return}var l=a.extend(true,{},this.defaultParams,{success:b.createDelegate(this,[k],1),error:f.createDelegate(this,[i],1),data:g});if(d){l.url=d}var e=a.ajax(l);if(this.opts.debug){usig.debug(l.dataType+" request...")}if(typeof(this.opts.afterServerRequest)=="function"){if(this.opts.debug){usig.debug("usig.AjaxComponent("+this.name+") calling afterServerRequest")}this.opts.afterServerRequest()}if(this.opts.serverTimeout>0){c=setTimeout(j.createDelegate(this,[e,l]),this.opts.serverTimeout)}return e},setOptions:function(b){this.opts=a.extend({},this.opts,b)},getOptions:function(){return this.opts}})})(jQuery);usig.AjaxComponent.defaults={debug:false,serverTimeout:30000,maxRetries:1};if(typeof(usig)=="undefined"){usig={}}usig.Inventario=(function(a){return usig.AjaxComponent.extend({lastRequest:null,lastRequestEpok:null,init:function(b){var c=a.extend({},usig.Inventario.defaults,b);this._super("Inventario",usig.Inventario.defaults.server,c)},getCategorias:function(c,b){this.lastRequest=this.mkRequest({},c,b,this.opts.server+"getCategorias/")},getParcelaPorDir:function(c,d,b){this.lastRequest=this.mkRequest({cod_calle:c.cod,altura:c.alt},d,b,this.opts.server+"getParcela/")},getDir:function(c,d,b){this.lastRequest=this.mkRequest(c,d,b,this.opts.server+"getDir/")},getParcela:function(d,c,e,b){this.lastRequest=this.mkRequest(d,e,b,this.opts.server+"getParcela"+c+"/")},getDatosTransporte:function(c,d,b){this.lastRequest=this.mkRequest(c,d,b,this.opts.server+"getDatosTransporte/")},buscar:function(i,h,c,b){var e=a.extend({},usig.Inventario.defaults.searchOptions,b),f={start:e.start,limit:e.limit,texto:i,tipo:e.tipoBusqueda,totalFull:e.totalFull};function d(j,m){var l={},k=[];a.each(j.clasesEncontradas,function(n,o){l[o.id]=new usig.inventario.Clase(o.id,o.nombre,o.nombreId,o.nombreNorm)});a.each(j.instancias,function(n,o){k.push(new usig.inventario.Objeto(o,l[o.claseId]))});if(typeof(m)=="function"){m(k)}}if(e.categoria!=undefined){f.categoria=e.categoria}if(e.clase!=undefined){f.clase=e.clase}if(e.bbox){f.bbox=[e.extent.left,e.extent.bottom,e.extent.right,e.extent.top].join(",")}var g=d.createDelegate(this,[h],1);if(e.returnRawData){g=h}if(e.searchInventario){this.lastRequest=this.mkRequest(f,g,c,this.opts.server+"buscar/")}if(e.searchEpok){this.lastRequestEpok=this.mkRequest(f,g,c,this.opts.serverEpok+"buscar/")}},getObjeto:function(d,e,b){function c(g,i,h){if(h instanceof usig.inventario.Objeto){if(this.opts.debug){usig.debug("Completando el objeto recibido")}h.fill(g);i(h)}else{if(this.opts.debug){usig.debug("Creando objeto nuevo")}i(new usig.inventario.Objeto(g))}}var f=typeof(d)=="object"?d.id:d;if(typeof(f)=="string"){this.lastRequestEpok=this.mkRequest({id:f},c.createDelegate(this,[e,d],1),b,this.opts.serverEpok+"getObjectContent/")}else{f=parseInt(f);if(f>0){this.lastRequest=this.mkRequest({id:f},c.createDelegate(this,[e,d],1),b,this.opts.server+"getObjectContent/")}}},getFeatureInfo:function(c,d,b){this.lastRequest=this.mkRequest(c,d,b,this.opts.server+"getObjectContent/")},getCloseFeatures:function(c,d,b){this.lastRequest=this.mkRequest(c,d,b,this.opts.server+"objetosCercanos/")},getGeom:function(b,d,c){this.lastRequest=this.mkRequest({id:b},d,c,this.opts.server+"getGeometria/")},abort:function(){if(this.lastRequest){if(this.opts.debug){usig.debug("Inventario: aborting last request.")}this.lastRequest.abort();this.lastRequest=null;if(typeof(this.opts.afterAbort)=="function"){this.opts.afterAbort()}}else{if(this.opts.debug){usig.debug("Inventario: abort failed. Too late!")}}}})})(jQuery);usig.Inventario.defaults={debug:false,server:"//inventario.usig.buenosaires.gob.ar/publico/",serverEpok:"//epok.buenosaires.gob.ar/",dataType:"jsonp",searchOptions:{start:0,limit:20,tipoBusqueda:"ranking",categoria:undefined,clase:undefined,bbox:false,totalFull:false,extent:undefined,returnRawData:false,searchInventario:false,searchEpok:true}};if(typeof(usig)=="undefined"){usig={}}if(typeof(usig.inventario)=="undefined"){usig.inventario={}}usig.inventario.Objeto=(function(a){return function(b,c){this.id=0;this.nombre=usig.inventario.Objeto.defaults.texts.noName;this.ubicacion=null;this.clase=c;this.direccionAsociada=null;this.fechaAlta=null;this.fechaUltimaModificacion=null;this.datos={};this.rawData={};this.descripcion=null;if(c!=undefined){this.descripcion=c.getNombre()}this.fill=function(d){if(d.id){this.id=d.id}if(d.nombre){this.nombre=d.nombre}if(d.ubicacion){this.ubicacion=new usig.inventario.Ubicacion(d.ubicacion);this.rawData.ubicacion=d.ubicacion}if(d.fechaAlta){this.fechaAlta=new Date(d.fechaAlta);this.rawData.fechaAlta=d.fechaAlta}if(d.fechaUltimaModificacion){this.fechaUltimaModificacion=new Date(d.fechaUltimaModificacion);this.rawData.fechaUltimaModificacion=d.fechaUltimaModificacion}if(d.direccionAsociada){try{this.direccionAsociada=usig.Direccion.fromObj(d.direccionAsociada);this.rawData.direccionAsociada=d.direccionAsociada}catch(f){}}else{if(d.direccionNormalizada&&usig.NormalizadorDirecciones){try{this.direccionAsociada=usig.NormalizadorDirecciones.normalizar(d.direccionNormalizada,10,true)[0];this.direccionAsociada.setCoordenadas(this.ubicacion.getCentroide());if(d.smp){this.direccionAsociada.setSmp(d.smp)}this.rawData.direccionAsociada=this.direccionAsociada.toJson()}catch(f){usig.debug(f)}}}if(d.contenido){var g=this.datos;a.each(d.contenido,function(h,e){g[e.nombreId]={alias:e.nombre,valor:e.valor,pos:e.posicion}});if(this.datos.nombre){this.nombre=this.datos.nombre.valor}}this.rawData=a.extend(this.rawData,d)};this.toString=function(){return this.nombre};this.getRawData=function(){return this.rawData};this.clone=function(){var d=new usig.inventario.Objeto(b,c);return a.extend(true,d,this)};this.toJson=function(){var d=this.getRawData();if(this.clase&&this.clase.toJson){d.clase=this.clase.toJson()}if(this.direccionAsociada&&this.direccionAsociada.toJson){d.direccionAsociada=this.direccionAsociada.toJson()}return d};this.isEqual=function(d){return d instanceof usig.inventario.Objeto&&d.id==this.id};this.getSmp=function(){return this.rawData.smp||(this.direccionAsociada?this.direccionAsociada.getSmp():"")};this.getCoordenadas=function(){if(this.ubicacion){return this.ubicacion.getCentroide()}else{if(this.direccionAsociada){return this.direccionAsociada.getCoordenadas()}}};this.fill(b);this.rawData=a.extend(this.rawData,b)}})(jQuery);usig.inventario.Objeto.fromObj=function(a){return new usig.inventario.Objeto(a,usig.inventario.Clase.fromObj(a.clase))};usig.inventario.Objeto.defaults={texts:{noName:"Sin Nombre"}};if(typeof(usig)=="undefined"){usig={}}if(typeof(usig.inventario)=="undefined"){usig.inventario={}}usig.inventario.Clase=function(d,c,b,a){this.getId=function(){return d};this.getNombre=function(){return c};this.getNombreId=function(){return b};this.getNombreNormalizado=function(){return a};this.toJson=function(){return{id:d,nombre:c,nombreId:b,nombreNormalizado:a}}};usig.inventario.Clase.fromObj=function(a){return new usig.inventario.Clase(a.id,a.nombre,a.nombreId,a.nombreNormalizado)};if(typeof(usig)=="undefined"){usig={}}if(typeof(usig.inventario)=="undefined"){usig.inventario={}}usig.inventario.Ubicacion=function(a){var b=null;if(a instanceof usig.Punto){b=a}else{if(a.centroide!=undefined){b=usig.Punto.fromWkt(a.centroide)}}this.getCentroide=function(){return b};this.getTipo=function(){return a.tipo}};